<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Get Distance</title>
</head>
<body>
    <div class="main">
        <button onclick="getUserLocation()">click!</button>
        <div id="latitude"></div>
        <div id="longitude"></div>
        <div id="ceta"></div>
        <div id="distance"></div>
    </div>
</body>
<script>
    var points = []
    function success({coords}) {
        var latitude = coords.latitude;
        var longitude = coords.longitude;
        
        document.getElementById("latitude").innerHTML += `[${points.length}] ` + latitude + "<br>";
        document.getElementById("longitude").innerHTML += `[${points.length}] ` + longitude + "<br>";
        points.push([latitude, longitude]);

        if (points.length >= 2) {
            var a = points[points.length - 1];
            var b = points[points.length - 2];

            var ceta = Math.acos((Math.cos(a[0])*Math.cos(a[1])*Math.cos(b[0])*Math.cos(b[1])) + (Math.cos(a[0])*Math.sin(a[1])*Math.cos(b[0])*Math.sin(b[1])) + (Math.sin(a[0])*Math.sin(b[0])));
            var distance = 6370623.42045529*ceta;

            document.getElementById("ceta").innerHTML = "ceta: " + ceta + " rad";
            document.getElementById("distance").innerHTML = "distance: " + distance + " m";
        }
    }

    function error() {
        alert("Error");
    }

    function getUserLocation() {
        if (!navigator.geolocation) {
            throw "위치 정보가 지원되지 않습니다!";
        }
        navigator.geolocation.getCurrentPosition(success, error, {enableHighAccuracy: true, maximumAge: 0, timeout: Infinity});
    }
</script>
</html>